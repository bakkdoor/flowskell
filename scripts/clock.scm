; clock
(define init   ; only until push+pop works
  (lambda ()
    (identity)
    (scale 0.25 -0.25 0.25)))
(define second-pointer
  (lambda ()
    (init)
    (rotate (* (modulo (secs) 60) 6) 0.0 0.0 1.0)
    (scale 1.0 0.025 0.025)
    (translate 1.0 0.0 0.0)
    (make-cube)))
(define minute-pointer
  (lambda ()
    (init)
    (rotate (* (modulo (secs) 3600) 0.1) 0.0 0.0 1.0)
    (scale 1.0 0.05 0.05)
    (translate 1.0 0.0 0.0)
    (make-cube)))
(define hour-pointer
  (lambda ()
    (init)
    (rotate (* (modulo (secs) (* 12 3600)) (/ 0.1 12)) 0.0 0.0 1.0)
    (scale 1.0 0.1 0.1)
    (translate 1.0 0.0 0.0)
    (make-cube)))
(define fat-ticks
  (lambda (n)
    (init)
    (rotate (* (/ n 12.0) 360.0) 0.0 0.0 1.0)
    (translate 2.0 0.0 0.0)
    (scale 0.04 0.04 0.04)
    (make-cube)
    (if (> n 0) (fat-ticks (- n 1.0)))))
(define ticks
  (lambda (n)
    (init)
    (rotate (* (/ n 60.0) 360.0) 0.0 0.0 1.0)
    (translate 2.0 0.0 0.0)
    (scale 0.01 0.01 0.01)
    (make-cube)
    (if (> n 0) (ticks (- n 1.0)))))
(define every-frame
  (lambda ()
    (ticks 60.0)
    (fat-ticks 12.0)
    (hour-pointer)
    (minute-pointer)
    (second-pointer)
    ))
