;
; A not-so-useful clock which does not display the current time
;
(define sweep-hand
  (lambda ()
    (push)
    (rotate (* (round (modulo (secs) 60)) 6) 0.0 0.0 1.0)
    (scale 0.5 0.015 0.015)
    (translate 1.0 0.0 0.0)
    (make-cube)
    (pop)))
(define minute-hand
  (lambda ()
    (push)
    (rotate (* (modulo (secs) 3600) 0.1) 0.0 0.0 1.0)
    (scale 0.5 0.03 0.03)
    (translate 1.0 0.0 0.0)
    (make-cube)
    (pop)))
(define hour-hand
  (lambda ()
    (push)
    (rotate (* (modulo (secs) (* 12 3600)) (/ 0.1 12)) 0.0 0.0 1.0)
    (scale 0.25 0.04 0.04)
    (translate 1.0 0.0 0.0)
    (make-cube)
    (pop)))
(define fat-ticks
  (lambda (n c)
    (push)
    (rotate (* (/ n c) 360.0) 0.0 0.0 1.0)
    (translate 1.0 0.0 0.0)
    (scale 0.04 0.04 0.04)
    (make-cube)
    (pop)
    (if (> n 0) (fat-ticks (- n 1) c))))
(define ticks
  (lambda (n c)
    (push)
    (rotate (* (/ n c) 360.0) 0.0 0.0 1.0)
    (translate 1.0 0.0 0.0)
    (scale 0.01 0.01 0.01)
    (make-cube)
    (pop)
    (if (> n 0) (ticks (- n 1) c))))
(define every-frame
  (lambda ()
    (scale 0.5 -0.5 0.5)
    (rotate 15.0 0.5 0.0 0.0)
    (translate 0.0 -0.1 0.0)
    ;(make-grid)
    (color 0.8 0.9 1.0)
    (ticks 60 60)
    (fat-ticks 12 12)
    (color 1.0 1.0 1.0)
    (hour-hand)
    (minute-hand)
    (sweep-hand)
    ))
